// Проверяем, есть ли сохраненное решение пользователя о доступе к местоположению
let geolocationAllowed = localStorage.getItem('geolocationAllowed');

if (geolocationAllowed === 'true') {
  // Доступ к местоположению разрешен, выполняем запрос
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
  } else {
    // Ваш браузер не поддерживает геолокацию
  }
} else if (geolocationAllowed === 'false') {
  // Доступ к местоположению запрещен, ничего не делаем
} else {
  // Пользователь еще не принял решение о доступе к местоположению
  window.onload = function() {
    if (!navigator.geolocation) {
      // Ваш браузер не поддерживает геолокацию
      return;
    }
    navigator.permissions.query({name:'geolocation'}).then(function(permissionStatus) {
      if (permissionStatus.state !== 'granted') {
        alert("Для синхронизации времени предоставьте доступ к определению местоположения.");
        localStorage.setItem('geolocationAllowed', 'false');
      } else {
        localStorage.setItem('geolocationAllowed', 'true');
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
        } else {
          // Ваш браузер не поддерживает геолокацию
        }
      }
    });
  };
}
